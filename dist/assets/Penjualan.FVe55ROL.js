import{s as q}from"./index.CuYCvLMm.js";import{s as A}from"./index.Cy1QRz5H.js";import{s as J}from"./index.Br3pg5oH.js";import{s as O}from"./index.DvIYg5kk.js";import{s as Y}from"./index.CjIJRkhO.js";import{s as G}from"./index.BrWMefaX.js";import{s as K}from"./index.DcXiv5Mf.js";import{u as i,G as W,b2 as z,v as Q,H as X,c as b,a as r,j as l,w as s,D as k,o as y,I as p,t as m,b3 as Z,l as w,a9 as ee}from"./app.nOLxvhWu.js";import{s as ae}from"./index.LwUBt43l.js";import"./index.B3MkBQPq.js";import"./index.DRGJws2w.js";import"./index.CYijPz_l.js";import"./index.Bx_AKhjG.js";import"./index.C_hQ_PNB.js";import"./index.5cZuQ5Px.js";import"./index.e64FBzf4.js";import"./index.pxpWFvq0.js";import"./index.B50m-utj.js";import"./index.DdSe4A1_.js";import"./index.4oY6l8P_.js";import"./index.CWP4Ac8B.js";import"./index.C9D36cqp.js";import"./index.D5s4REby.js";import"./index.2k1OPD85.js";import"./index.C7L-0-uQ.js";import"./index.DbRB8EwJ.js";var te={name:"Calendar",extends:ae,mounted:function(){console.warn("Deprecated since v4. Use DatePicker component instead.")}};const le={class:"card"},oe={class:"flex flex-wrap gap-2 items-center justify-between"},ne=r("h4",{class:"m-3 font-bold"},"Manajemen Penjualan",-1),se={class:"flex flex-col gap-6"},re={key:0},ie=r("label",{for:"tanggal",class:"block font-bold mb-3"},"Tanggal Terjual",-1),ue=r("label",{for:"harga_jual",class:"block font-bold mb-3"},"Harga Jual",-1),de={class:"flex items-center gap-4"},ce=r("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),pe={key:0},me={class:"flex items-center gap-4"},fe=r("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),ve={key:0},qe={__name:"Penjualan",setup(C){const g=i({global:{value:null,matchMode:ee.CONTAINS}}),u=i(),_=async()=>{try{const e=await k.get("/api/penjualan");u.value=e.data}catch(e){console.error("Error fetching penjualan:",e)}},j=i();W(()=>{_(),j.value=setInterval(_,1e4)}),z(()=>{j.value&&clearInterval(j.value)});const c=Q(),x=i(),f=i(!1),n=i({}),h=i(),v=i(!1);X(()=>{var t;const e=((t=g.value.global.value)==null?void 0:t.toLowerCase())||"";return u.value.filter(a=>a.stok_hp.imei.toLowerCase().includes(e)||a.stok_hp.brand.toLowerCase().includes(e)||a.stok_hp.nama.toLowerCase().includes(e)||a.stok_hp.warna.toLowerCase().includes(e)||a.stok_hp.harga_masuk.toString().toLowerCase().includes(e)||a.harga_jual.toString().toLowerCase().includes(e)||a.users.nama.toLowerCase().includes(e))});const D=i(!1);function I(e){return e!=null?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round(e)):"-"}function L(e){n.value={...e},f.value=!0}function $(){f.value=!1,D.value=!1}function S(){D.value=!0,n!=null&&n.value.id_penjualan&&k.put(`/api/penjualan/${n.value.id_penjualan}`,{...n.value}).then(()=>{const e=V(n.value.id_penjualan);u.value[e]=n.value,_(),c.add({severity:"success",summary:"Successful",detail:"Penjualan Updated",life:3e3})}).catch(e=>{c.add({severity:"error",summary:"Error",detail:"Failed to update penjualan",life:3e3})}),f.value=!1,n.value={}}function V(e){let t=-1;for(let a=0;a<u.value.length;a++)if(u.value[a].id_penjualan===e){t=a;break}return t}function N(e){n.value=e,v.value=!0}function T(){k.delete(`/api/penjualan/${n.value.id_penjualan}`).then(()=>{u.value=u.value.filter(e=>e.id_penjualan!==n.value.id_penjualan),_(),c.add({severity:"success",summary:"Successful",detail:"Penjualan Deleted",life:3e3})}).catch(e=>{c.add({severity:"error",summary:"Error",detail:"Failed to delete penjualan",life:3e3})}),v.value=!1,n.value={}}function U(){deleteProductsDialog.value=!0}function F(){const e=selectedProducts.value.map(a=>a.id_stock),t=e.map(a=>k.delete(`/api/stocks/${a}`));Promise.all(t).then(()=>{products.value=products.value.filter(a=>!e.includes(a.id_stock)),fetchProducts(),c.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})}).catch(a=>{c.add({severity:"error",summary:"Error",detail:"Failed to delete selected products",life:3e3})}),deleteProductsDialog.value=!1,selectedProducts.value=null}return(e,t)=>{const a=K,M=G,E=Y,d=O,R=J,B=A,P=q;return y(),b("div",null,[r("div",le,[l(M,{class:"mb-6"},{start:s(()=>[l(a,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:U,disabled:!h.value||!h.value.length},null,8,["disabled"])]),_:1}),l(R,{ref_key:"dt",ref:x,selection:h.value,"onUpdate:selection":t[1]||(t[1]=o=>h.value=o),value:u.value,dataKey:"id",paginator:!0,rows:10,filters:g.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} penjualan"},{header:s(()=>[r("div",oe,[ne,l(E,{modelValue:g.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value.global.value=o),placeholder:"Search...",class:"w-full md:w-auto"},null,8,["modelValue"])])]),default:s(()=>[l(d,{field:"tanggal",header:"Tanggal Terjual",sortable:""},{body:s(o=>[p(m(new Date(o.data.tanggal).toLocaleDateString("id-ID")),1)]),_:1}),l(d,{field:"users.nama",header:"Sales",sortable:""},{default:s(()=>[p(m(e.slotProps.data.users.nama||"Unknown"),1)]),_:1}),l(d,{field:"stok_hp.nama",header:"Nama HP",sortable:""},{default:s(()=>[p(m(e.slotProps.data.stok_hp.nama),1)]),_:1}),l(d,{field:"stok_hp.warna",header:"Warna",sortable:""},{default:s(()=>[p(m(e.slotProps.data.stok_hp.warna),1)]),_:1}),l(d,{field:"stok_hp.imei",header:"IMEI",sortable:""},{default:s(()=>[p(m(e.slotProps.data.stok_hp.imei),1)]),_:1}),l(d,{field:"harga_jual",header:"Harga Jual",sortable:""},{body:s(o=>[p(m(I(o.data.harga_jual)),1)]),_:1}),l(d,{exportable:!1,style:{"min-width":"12rem"}},{body:s(o=>[l(a,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:H=>L(o.data)},null,8,["onClick"]),l(a,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:H=>N(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),l(P,{visible:f.value,"onUpdate:visible":t[4]||(t[4]=o=>f.value=o),style:{width:"450px"},header:"Penjualan Details",modal:!0},{footer:s(()=>[l(a,{label:"Cancel",icon:"pi pi-times",text:"",onClick:$}),l(a,{label:"Save",icon:"pi pi-check",onClick:S})]),default:s(()=>[r("div",se,[n.value.id_penjualan?w("",!0):(y(),b("div",re,[ie,l(Z(te),{id:"tanggal",modelValue:n.value.tanggal,"onUpdate:modelValue":t[2]||(t[2]=o=>n.value.tanggal=o),modelModifiers:{trim:!0},required:"",fluid:"",disabled:!!n.value.id_penjualan},null,8,["modelValue","disabled"])])),r("div",null,[ue,l(B,{id:"harga_jual",modelValue:n.value.harga_jual,"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.harga_jual=o),required:"",mode:"currency",currency:"IDR",locale:"id-ID",fluid:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),l(P,{visible:v.value,"onUpdate:visible":t[6]||(t[6]=o=>v.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[l(a,{label:"No",icon:"pi pi-times",text:"",onClick:t[5]||(t[5]=o=>v.value=!1)}),l(a,{label:"Yes",icon:"pi pi-check",onClick:T})]),default:s(()=>[r("div",de,[ce,n.value?(y(),b("span",pe,"Are you sure you want to delete this sale?")):w("",!0)])]),_:1},8,["visible"]),l(P,{visible:e.deleteProductsDialog,"onUpdate:visible":t[8]||(t[8]=o=>e.deleteProductsDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[l(a,{label:"No",icon:"pi pi-times",text:"",onClick:t[7]||(t[7]=o=>e.deleteProductsDialog=!1)}),l(a,{label:"Yes",icon:"pi pi-check",text:"",onClick:F})]),default:s(()=>[r("div",me,[fe,e.product?(y(),b("span",ve,"Are you sure you want to delete the selected products?")):w("",!0)])]),_:1},8,["visible"])])}}};export{qe as default};
