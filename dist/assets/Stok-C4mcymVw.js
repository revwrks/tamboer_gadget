import{s as Q}from"./index-DkALPWFA.js";import{s as X}from"./index-CJ8ekP3G.js";import{s as Z}from"./index-B4Xv1ZwY.js";import{s as ee}from"./index-DCxt4kfF.js";import{s as ae}from"./index-BA0srxou.js";import{s as te}from"./index-B9wN6odX.js";import{s as le,a as oe}from"./index-7NfMgPtW.js";import{s as se}from"./index-CoBzH7kO.js";import{s as re}from"./index-DIVZp-3M.js";import{s as ie}from"./index-To1EL0yG.js";import{u as p,G as ue,v as de,b1 as ne,c as m,a as r,k as o,w as u,D as _,o as v,O as x,t as D,n as f,a9 as ce}from"./app-BfcKqKZR.js";import"./index-73WnsLPp.js";import"./index-C8ISe5pD.js";import"./index-COPg_oHH.js";import"./index-DcM61d9B.js";import"./index-BQeZ6xy6.js";import"./index-Djj8ZdFd.js";import"./index-BYK7Dss3.js";import"./index-BznmajbO.js";import"./index-BdsKkoRL.js";import"./index-BGxAnED2.js";import"./index-CTUZfXvO.js";import"./index-BLhvAVcQ.js";import"./index-DaGWxQwt.js";import"./index-NZ5c_KPD.js";import"./index-CBGtxqMA.js";import"./index-BTez14rp.js";const me={class:"card"},ve={class:"flex flex-wrap gap-2 items-center justify-between"},pe=r("h4",{class:"m-0"},"Manage Products",-1),fe=r("i",{class:"pi pi-search"},null,-1),_e={class:"flex flex-col gap-6"},ge=r("label",{for:"tanggal",class:"block font-bold mb-3"},"Tanggal",-1),be={key:0,class:"text-red-500"},ke=r("label",{for:"imei",class:"block font-bold mb-3"},"IMEI",-1),ye={key:0,class:"text-red-500"},he=r("label",{for:"brand",class:"block font-bold mb-3"},"Brand",-1),we={key:0,class:"text-red-500"},xe=r("label",{for:"nama",class:"block font-bold mb-3"},"Nama",-1),Ce={key:0,class:"text-red-500"},Ve=r("label",{for:"warna",class:"block font-bold mb-3"},"Warna",-1),De={key:0,class:"text-red-500"},Pe=r("label",{for:"harga_masuk",class:"block font-bold mb-3"},"Harga Masuk",-1),Se={key:0,class:"text-red-500"},Ie=r("label",{for:"harga_jual",class:"block font-bold mb-3"},"Harga Jual",-1),je={key:0,class:"text-red-500"},$e={class:"flex items-center gap-4"},Me=r("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),Le={key:0},Ne={class:"flex items-center gap-4"},qe=r("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),Fe={key:0},ca={__name:"Stok",setup(Ue){const C=p({global:{value:null,matchMode:ce.CONTAINS}}),d=p(),g=async()=>{try{const t=await _.get("/api/stocks");d.value=t.data}catch(t){console.error("Error fetching products:",t)}};ue(g);const n=de(),S=p(),b=p(!1),y=p(!1),h=p(!1),e=p({}),k=p();ne(()=>{var a;const t=((a=C.value.global.value)==null?void 0:a.toLowerCase())||"";return d.value.filter(s=>s.imei.toLowerCase().includes(t)||s.brand.toLowerCase().includes(t)||s.nama.toLowerCase().includes(t)||s.warna.toLowerCase().includes(t)||s.harga_masuk.toLowerCase().includes(t)||s.harga_jual.toLowerCase().includes(t)||s.status.toLowerCase().includes(t))});const i=p(!1);function I(t){return t!=null?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round(t)):"-"}function M(t){switch(t){case"ada":return"Ready";case"terjual":return"Sold";default:return t}}function L(t){switch(t){case"ada":return"success";case"terjual":return"danger";default:return null}}function N(){e.value={},e.value.tanggal=new Date,i.value=!1,b.value=!0}function q(){b.value=!1,i.value=!1}function F(){var t;i.value=!0,(t=e==null?void 0:e.value.nama)!=null&&t.trim()&&(e.value.id_stock?_.put(`/api/stocks/${e.value.id_stock}`,{...e.value,status:e.value.status||"ada"}).then(()=>{const a=H(e.value.id_stock);d.value[a]=e.value,g(),n.add({severity:"success",summary:"Successful",detail:"Product Updated",life:3e3})}).catch(a=>{n.add({severity:"error",summary:"Error",detail:"Failed to update product",life:3e3})}):_.post("/api/stocks",{...e.value,id:null,status:"ada"}).then(a=>{e.value.id_stock=a.data.stok_hp.id_stock,d.value.push(e.value),g(),n.add({severity:"success",summary:"Successful",detail:"Product Created",life:3e3})}).catch(a=>{n.add({severity:"error",summary:"Error",detail:"Failed to create product",life:3e3})}),b.value=!1,e.value={})}function U(t){const a={ada:1,terjual:2};t.data.sort((s,V)=>a[s.status]-a[V.status])}function E(t){const a=localStorage.getItem("token");_.post("/api/penjualan",{tanggal:new Date,id_stock:t.id_stock,harga_jual:t.harga_jual,id_sales:a}).then(s=>{_.put(`/api/stocks/${t.id_stock}`,{status:"terjual"}).then(()=>{g(),n.add({severity:"success",summary:"Success",detail:"Penjualan created and stock updated",life:3e3})}).catch(V=>{n.add({severity:"error",summary:"Error",detail:"Failed to update stock status",life:3e3})})}).catch(s=>{n.add({severity:"error",summary:"Error",detail:"Failed to create penjualan",life:3e3})})}function T(t){e.value={...t},b.value=!0}function B(t){e.value=t,y.value=!0}function R(){_.delete(`/api/stocks/${e.value.id_stock}`).then(()=>{d.value=d.value.filter(t=>t.id_stock!==e.value.id_stock),g(),n.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3})}).catch(t=>{n.add({severity:"error",summary:"Error",detail:"Failed to delete product",life:3e3})}),y.value=!1,e.value={}}function H(t){let a=-1;for(let s=0;s<d.value.length;s++)if(d.value[s].id_stock===t){a=s;break}return a}function O(){S.value.exportCSV()}function A(){h.value=!0}function J(){const t=k.value.map(s=>s.id_stock),a=t.map(s=>_.delete(`/api/stocks/${s}`));Promise.all(a).then(()=>{d.value=d.value.filter(s=>!t.includes(s.id_stock)),g(),n.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})}).catch(s=>{n.add({severity:"error",summary:"Error",detail:"Failed to delete selected products",life:3e3})}),h.value=!1,k.value=null}return(t,a)=>{const s=ie,V=re,W=le,w=se,Y=oe,c=te,G=ae,K=ee,z=Z,j=X,P=Q;return v(),m("div",null,[r("div",me,[o(V,{class:"mb-6"},{start:u(()=>[o(s,{label:"New",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:N}),o(s,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:A,disabled:!k.value||!k.value.length},null,8,["disabled"])]),end:u(()=>[o(s,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:a[0]||(a[0]=l=>O(l))})]),_:1}),o(K,{ref_key:"dt",ref:S,selection:k.value,"onUpdate:selection":a[2]||(a[2]=l=>k.value=l),value:d.value,dataKey:"id_stock",paginator:!0,rows:10,filters:C.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",sortField:"status",sortOrder:1,customSort:!0,onSort:U},{header:u(()=>[r("div",ve,[pe,o(Y,null,{default:u(()=>[o(W,null,{default:u(()=>[fe]),_:1}),o(w,{modelValue:C.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=l=>C.value.global.value=l),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:u(()=>[o(c,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),o(c,{field:"tanggal",header:"Tanggal",sortable:""},{body:u(l=>[x(D(new Date(l.data.tanggal).toLocaleDateString("id-ID")),1)]),_:1}),o(c,{field:"status",header:"Status",sortable:"",style:{"min-width":"5rem"}},{body:u(l=>[o(G,{value:M(l.data.status),severity:L(l.data.status)},null,8,["value","severity"])]),_:1}),o(c,{field:"nama",header:"Nama",sortable:"",style:{"min-width":"12rem"}}),o(c,{field:"warna",header:"Warna",sortable:"",style:{"min-width":"12rem"}}),o(c,{field:"harga_masuk",header:"Harga Masuk",sortable:"",style:{"min-width":"8rem"}},{body:u(l=>[x(D(I(l.data.harga_masuk)),1)]),_:1}),o(c,{field:"harga_jual",header:"Harga Jual",sortable:"",style:{"min-width":"8rem"}},{body:u(l=>[x(D(I(l.data.harga_jual)),1)]),_:1}),o(c,{field:"brand",header:"Brand",sortable:"",style:{"min-width":"12rem"}}),o(c,{field:"imei",header:"IMEI",sortable:"",style:{"min-width":"12rem"}}),o(c,{exportable:!1,style:{"min-width":"12rem"}},{body:u(l=>[o(s,{icon:"pi pi-money-bill",outlined:"",rounded:"",class:"mr-2",onClick:$=>E(l.data),disabled:l.data.status==="terjual"},null,8,["onClick","disabled"]),o(s,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:$=>T(l.data)},null,8,["onClick"]),o(s,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:$=>B(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),o(P,{visible:b.value,"onUpdate:visible":a[10]||(a[10]=l=>b.value=l),style:{width:"450px"},header:"Product Details",modal:!0},{footer:u(()=>[o(s,{label:"Cancel",icon:"pi pi-times",text:"",onClick:q}),o(s,{label:"Save",icon:"pi pi-check",onClick:F})]),default:u(()=>[r("div",_e,[r("div",null,[ge,o(z,{id:"tanggal",modelValue:e.value.tanggal,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.tanggal=l),modelModifiers:{trim:!0},required:"",dateFormat:"dd/mm/yy",autofocus:"",invalid:i.value&&!e.value.tanggal,fluid:"",showIcon:"",disabled:!!e.value.id_stock},null,8,["modelValue","invalid","disabled"]),i.value&&!e.value.tanggal?(v(),m("small",be,"Tanggal is required.")):f("",!0)]),r("div",null,[ke,o(w,{id:"imei",modelValue:e.value.imei,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.imei=l),modelModifiers:{trim:!0},required:"",invalid:i.value&&!e.value.imei,fluid:"",disabled:!!e.value.id_stock},null,8,["modelValue","invalid","disabled"]),i.value&&!e.value.imei?(v(),m("small",ye,"IMEI is required.")):f("",!0)]),r("div",null,[he,o(w,{id:"brand",modelValue:e.value.brand,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.brand=l),modelModifiers:{trim:!0},required:"",invalid:i.value&&!e.value.brand,fluid:""},null,8,["modelValue","invalid"]),i.value&&!e.value.brand?(v(),m("small",we,"Brand is required.")):f("",!0)]),r("div",null,[xe,o(w,{id:"nama",modelValue:e.value.nama,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.nama=l),modelModifiers:{trim:!0},required:"",invalid:i.value&&!e.value.nama,fluid:""},null,8,["modelValue","invalid"]),i.value&&!e.value.nama?(v(),m("small",Ce,"Nama is required.")):f("",!0)]),r("div",null,[Ve,o(w,{id:"warna",modelValue:e.value.warna,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.warna=l),modelModifiers:{trim:!0},required:"",invalid:i.value&&!e.value.warna,fluid:""},null,8,["modelValue","invalid"]),i.value&&!e.value.warna?(v(),m("small",De,"Warna is required.")):f("",!0)]),r("div",null,[Pe,o(j,{id:"harga_masuk",modelValue:e.value.harga_masuk,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.harga_masuk=l),required:"",mode:"currency",currency:"IDR",locale:"id-ID",fluid:"",invalid:i.value&&!e.value.harga_masuk},null,8,["modelValue","invalid"]),i.value&&!e.value.harga_masuk?(v(),m("small",Se,"Harga Masuk is required.")):f("",!0)]),r("div",null,[Ie,o(j,{id:"harga_jual",modelValue:e.value.harga_jual,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.harga_jual=l),required:"",mode:"currency",currency:"IDR",locale:"id-ID",fluid:"",invalid:i.value&&!e.value.harga_jual},null,8,["modelValue","invalid"]),i.value&&!e.value.harga_jual?(v(),m("small",je,"Harga Jual is required.")):f("",!0)])])]),_:1},8,["visible"]),o(P,{visible:y.value,"onUpdate:visible":a[12]||(a[12]=l=>y.value=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:u(()=>[o(s,{label:"No",icon:"pi pi-times",text:"",onClick:a[11]||(a[11]=l=>y.value=!1)}),o(s,{label:"Yes",icon:"pi pi-check",onClick:R})]),default:u(()=>[r("div",$e,[Me,e.value?(v(),m("span",Le,[x("Are you sure you want to delete "),r("b",null,D(e.value.name),1),x("?")])):f("",!0)])]),_:1},8,["visible"]),o(P,{visible:h.value,"onUpdate:visible":a[14]||(a[14]=l=>h.value=l),style:{width:"450px"},header:"Confirm",modal:!0},{footer:u(()=>[o(s,{label:"No",icon:"pi pi-times",text:"",onClick:a[13]||(a[13]=l=>h.value=!1)}),o(s,{label:"Yes",icon:"pi pi-check",text:"",onClick:J})]),default:u(()=>[r("div",Ne,[qe,e.value?(v(),m("span",Fe,"Are you sure you want to delete the selected products?")):f("",!0)])]),_:1},8,["visible"])])}}};export{ca as default};
