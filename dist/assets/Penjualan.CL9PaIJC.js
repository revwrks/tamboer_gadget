import{s as A}from"./index.Dmfi-JIL.js";import{s as H}from"./index.BIGMjE8y.js";import{s as O}from"./index.BimSrEtP.js";import{s as J}from"./index.D9lkt8EW.js";import{s as Y}from"./index.DFT7lvgp.js";import{s as G}from"./index.DSQTaGDn.js";import{s as K}from"./index.zYXIKiL0.js";import{u as i,G as W,b1 as z,v as Q,b2 as X,c as b,a as r,k as l,w as n,D as k,o as y,O as p,t as m,b3 as Z,n as w,a9 as ee}from"./app.DYb4vtlo.js";import{s as ae}from"./index.DNQVPJbx.js";import"./index.D2YcutoK.js";import"./index.DU--r9eK.js";import"./index.Dl32Gjrb.js";import"./index.C5jhljM2.js";import"./index.yeH71diU.js";import"./index.DBRa2qmt.js";import"./index.BLUoHmHi.js";import"./index.QuCDjsSy.js";import"./index.DBHWkPF6.js";import"./index.CqPNYfth.js";import"./index.Ddk8Teb6.js";import"./index.IlhIhN8w.js";import"./index.CnjyFZOC.js";import"./index.D4jsbkbY.js";import"./index.DkZQtvKd.js";import"./index.oaTq0kd9.js";import"./index.By_UZaj1.js";var te={name:"Calendar",extends:ae,mounted:function(){console.warn("Deprecated since v4. Use DatePicker component instead.")}};const le={class:"card"},oe={class:"flex flex-wrap gap-2 items-center justify-between"},se=r("h4",{class:"m-0"},"Manage Penjualan",-1),ne={class:"flex flex-col gap-6"},re={key:0},ie=r("label",{for:"tanggal",class:"block font-bold mb-3"},"Tanggal Terjual",-1),ue=r("label",{for:"harga_jual",class:"block font-bold mb-3"},"Harga Jual",-1),de={class:"flex items-center gap-4"},ce=r("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),pe={key:0},me={class:"flex items-center gap-4"},fe=r("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1),ve={key:0},Ae={__name:"Penjualan",setup(C){const g=i({global:{value:null,matchMode:ee.CONTAINS}}),u=i(),_=async()=>{try{const e=await k.get("/api/penjualan");u.value=e.data}catch(e){console.error("Error fetching penjualan:",e)}},P=i();W(()=>{_(),P.value=setInterval(_,1e4)}),z(()=>{P.value&&clearInterval(P.value)});const c=Q(),x=i(),f=i(!1),s=i({}),h=i(),v=i(!1);X(()=>{var t;const e=((t=g.value.global.value)==null?void 0:t.toLowerCase())||"";return u.value.filter(a=>a.stok_hp.imei.toLowerCase().includes(e)||a.stok_hp.brand.toLowerCase().includes(e)||a.stok_hp.nama.toLowerCase().includes(e)||a.stok_hp.warna.toLowerCase().includes(e)||a.stok_hp.harga_masuk.toString().toLowerCase().includes(e)||a.harga_jual.toString().toLowerCase().includes(e)||a.users.nama.toLowerCase().includes(e))});const D=i(!1);function I(e){return e!=null?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round(e)):"-"}function L(e){s.value={...e},f.value=!0}function $(){f.value=!1,D.value=!1}function S(){D.value=!0,s!=null&&s.value.id_penjualan&&k.put(`/api/penjualan/${s.value.id_penjualan}`,{...s.value}).then(()=>{const e=V(s.value.id_penjualan);u.value[e]=s.value,_(),c.add({severity:"success",summary:"Successful",detail:"Penjualan Updated",life:3e3})}).catch(e=>{c.add({severity:"error",summary:"Error",detail:"Failed to update penjualan",life:3e3})}),f.value=!1,s.value={}}function V(e){let t=-1;for(let a=0;a<u.value.length;a++)if(u.value[a].id_penjualan===e){t=a;break}return t}function N(e){s.value=e,v.value=!0}function T(){k.delete(`/api/penjualan/${s.value.id_penjualan}`).then(()=>{u.value=u.value.filter(e=>e.id_penjualan!==s.value.id_penjualan),_(),c.add({severity:"success",summary:"Successful",detail:"Penjualan Deleted",life:3e3})}).catch(e=>{c.add({severity:"error",summary:"Error",detail:"Failed to delete penjualan",life:3e3})}),v.value=!1,s.value={}}function U(){deleteProductsDialog.value=!0}function F(){const e=selectedProducts.value.map(a=>a.id_stock),t=e.map(a=>k.delete(`/api/stocks/${a}`));Promise.all(t).then(()=>{products.value=products.value.filter(a=>!e.includes(a.id_stock)),fetchProducts(),c.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})}).catch(a=>{c.add({severity:"error",summary:"Error",detail:"Failed to delete selected products",life:3e3})}),deleteProductsDialog.value=!1,selectedProducts.value=null}return(e,t)=>{const a=K,M=G,E=Y,d=J,R=O,B=H,j=A;return y(),b("div",null,[r("div",le,[l(M,{class:"mb-6"},{start:n(()=>[l(a,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:U,disabled:!h.value||!h.value.length},null,8,["disabled"])]),_:1}),l(R,{ref_key:"dt",ref:x,selection:h.value,"onUpdate:selection":t[1]||(t[1]=o=>h.value=o),value:u.value,dataKey:"id",paginator:!0,rows:10,filters:g.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} penjualan"},{header:n(()=>[r("div",oe,[se,l(E,{modelValue:g.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value.global.value=o),placeholder:"Search...",class:"w-full md:w-auto"},null,8,["modelValue"])])]),default:n(()=>[l(d,{field:"tanggal",header:"Tanggal Terjual",sortable:""},{body:n(o=>[p(m(new Date(o.data.tanggal).toLocaleDateString("id-ID")),1)]),_:1}),l(d,{field:"users.nama",header:"Sales",sortable:""},{default:n(()=>[p(m(e.slotProps.data.users.nama||"Unknown"),1)]),_:1}),l(d,{field:"stok_hp.nama",header:"Nama HP",sortable:""},{default:n(()=>[p(m(e.slotProps.data.stok_hp.nama),1)]),_:1}),l(d,{field:"stok_hp.warna",header:"Warna",sortable:""},{default:n(()=>[p(m(e.slotProps.data.stok_hp.warna),1)]),_:1}),l(d,{field:"stok_hp.imei",header:"IMEI",sortable:""},{default:n(()=>[p(m(e.slotProps.data.stok_hp.imei),1)]),_:1}),l(d,{field:"harga_jual",header:"Harga Jual",sortable:""},{body:n(o=>[p(m(I(o.data.harga_jual)),1)]),_:1}),l(d,{exportable:!1,style:{"min-width":"12rem"}},{body:n(o=>[l(a,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:q=>L(o.data)},null,8,["onClick"]),l(a,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:q=>N(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),l(j,{visible:f.value,"onUpdate:visible":t[4]||(t[4]=o=>f.value=o),style:{width:"450px"},header:"Penjualan Details",modal:!0},{footer:n(()=>[l(a,{label:"Cancel",icon:"pi pi-times",text:"",onClick:$}),l(a,{label:"Save",icon:"pi pi-check",onClick:S})]),default:n(()=>[r("div",ne,[s.value.id_penjualan?w("",!0):(y(),b("div",re,[ie,l(Z(te),{id:"tanggal",modelValue:s.value.tanggal,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.tanggal=o),modelModifiers:{trim:!0},required:"",fluid:"",disabled:!!s.value.id_penjualan},null,8,["modelValue","disabled"])])),r("div",null,[ue,l(B,{id:"harga_jual",modelValue:s.value.harga_jual,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.harga_jual=o),required:"",mode:"currency",currency:"IDR",locale:"id-ID",fluid:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),l(j,{visible:v.value,"onUpdate:visible":t[6]||(t[6]=o=>v.value=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[l(a,{label:"No",icon:"pi pi-times",text:"",onClick:t[5]||(t[5]=o=>v.value=!1)}),l(a,{label:"Yes",icon:"pi pi-check",onClick:T})]),default:n(()=>[r("div",de,[ce,s.value?(y(),b("span",pe,"Are you sure you want to delete this sale?")):w("",!0)])]),_:1},8,["visible"]),l(j,{visible:e.deleteProductsDialog,"onUpdate:visible":t[8]||(t[8]=o=>e.deleteProductsDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:n(()=>[l(a,{label:"No",icon:"pi pi-times",text:"",onClick:t[7]||(t[7]=o=>e.deleteProductsDialog=!1)}),l(a,{label:"Yes",icon:"pi pi-check",text:"",onClick:F})]),default:n(()=>[r("div",me,[fe,e.product?(y(),b("span",ve,"Are you sure you want to delete the selected products?")):w("",!0)])]),_:1},8,["visible"])])}}};export{Ae as default};
