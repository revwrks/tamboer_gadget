import{s as H}from"./index.BbmNYN32.js";import{s as Y}from"./index.B6mBdOK6.js";import{s as j}from"./index._5o7aNuM.js";import{s as G}from"./index.CQlLIbLC.js";import{s as K,a as z}from"./index.C8MQ2szf.js";import{s as J}from"./index.Ds35Vzkf.js";import{s as Q}from"./index.C9N4WFBj.js";import{s as W}from"./index.BcT575Nn.js";import{u as d,G as X,v as Z,b1 as ee,c as _,a as r,k as s,w as i,D as x,o as y,n as g,t as le,a9 as ae}from"./app.5WlxmkjR.js";import"./index.DA1NGDc9.js";import"./index.EOTHL6gN.js";import"./index.Bua6rbdJ.js";import"./index.DFyDvela.js";import"./index.COWMYEng.js";import"./index.1bV2Ar9K.js";import"./index.DOTFLFqf.js";import"./index.utu5xtgu.js";import"./index.CMcXutYM.js";import"./index.jgIYzqYJ.js";import"./index.DdXA0FTl.js";import"./index.DRWH-0hi.js";import"./index.B_xps0mq.js";import"./index.B4UvZ2K7.js";var se={name:"Dropdown",extends:Y,mounted:function(){console.warn("Deprecated since v4. Use Select component instead.")}};const te={class:"card"},oe={class:"flex flex-wrap gap-2 items-center justify-between"},re=r("h4",{class:"m-0"},"Manage Users",-1),ie=r("i",{class:"pi pi-search"},null,-1),ue={class:"flex flex-col gap-6"},ne=r("label",{for:"username",class:"block font-bold mb-3"},"Username",-1),de={key:0,class:"text-red-500"},ve=r("label",{for:"nama",class:"block font-bold mb-3"},"Nama",-1),ce={key:0,class:"text-red-500"},me=r("label",{for:"level",class:"block font-bold mb-3"},"Level",-1),pe={key:0,class:"text-red-500"},fe={key:0},be=r("label",{for:"password",class:"block font-bold mb-3"},"Password",-1),_e={key:0,class:"text-red-500"},ye=r("p",null,"Are you sure you want to delete the selected users?",-1),Oe={__name:"Akun",setup(D){const h=d({global:{value:null,matchMode:ae.CONTAINS}}),u=d([]),w=async()=>{try{const o=await x.get("/api/users");u.value=o.data}catch(o){console.error("Error fetching users:",o)}};X(w);const v=Z(),V=d(),m=d(!1),p=d(!1),f=d(!1),e=d({}),b=d();ee(()=>{var l;const o=((l=h.value.global.value)==null?void 0:l.toLowerCase())||"";return u.value.filter(a=>a.username.toLowerCase().includes(o)||a.nama.toLowerCase().includes(o)||a.level.toLowerCase().includes(o))});const n=d(!1);function $(){e.value={},n.value=!1,m.value=!0}function S(){m.value=!1,n.value=!1}function L(){var o,l;if(n.value=!0,(o=e==null?void 0:e.value.username)!=null&&o.trim()&&((l=e==null?void 0:e.value.nama)!=null&&l.trim())&&(e!=null&&e.value.level)){const a={...e.value,level:e.value.level.value};e.value.id_user?x.put(`/api/users/${e.value.id_user}`,a).then(()=>{const c=M(e.value.id_user);u.value[c]=e.value,w(),v.add({severity:"success",summary:"Successful",detail:"User Updated",life:3e3})}).catch(c=>{v.add({severity:"error",summary:"Error",detail:"Failed to update user",life:3e3})}):x.post("/api/users",a).then(c=>{e.value.id_user=c.data.user.id_user,u.value.push(e.value),w(),v.add({severity:"success",summary:"Successful",detail:"User Created",life:3e3})}).catch(c=>{v.add({severity:"error",summary:"Error",detail:"Failed to create user",life:3e3})}),m.value=!1,e.value={}}}function P(o){e.value={...o},m.value=!0}function N(o){e.value=o,p.value=!0}function q(){x.delete(`/api/users/${e.value.id_user}`).then(()=>{u.value=u.value.filter(o=>o.id_user!==e.value.id_user),w(),v.add({severity:"success",summary:"Successful",detail:"User Deleted",life:3e3})}).catch(o=>{v.add({severity:"error",summary:"Error",detail:"Failed to delete user",life:3e3})}),p.value=!1,e.value={}}function M(o){let l=-1;for(let a=0;a<u.value.length;a++)if(u.value[a].id_user===o){l=a;break}return l}function E(){V.value.exportCSV()}function F(){f.value=!0}function I(){const o=b.value.map(a=>a.id_user),l=o.map(a=>x.delete(`/api/users/${a}`));Promise.all(l).then(()=>{u.value=u.value.filter(a=>!o.includes(a.id_user)),w(),v.add({severity:"success",summary:"Successful",detail:"Users Deleted",life:3e3})}).catch(a=>{v.add({severity:"error",summary:"Error",detail:"Failed to delete selected users",life:3e3})}),f.value=!1,b.value=null}return(o,l)=>{const a=W,c=Q,T=K,U=J,B=z,k=G,A=j,R=se,C=H;return y(),_("div",null,[r("div",te,[s(c,{class:"mb-6"},{start:i(()=>[s(a,{label:"New",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:$}),s(a,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:F,disabled:!b.value||!b.value.length},null,8,["disabled"])]),end:i(()=>[s(a,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:l[0]||(l[0]=t=>E(t))})]),_:1}),s(A,{ref_key:"dt",ref:V,selection:b.value,"onUpdate:selection":l[2]||(l[2]=t=>b.value=t),value:u.value,dataKey:"id_user",paginator:!0,rows:10,filters:h.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} users"},{header:i(()=>[r("div",oe,[re,s(B,null,{default:i(()=>[s(T,null,{default:i(()=>[ie]),_:1}),s(U,{modelValue:h.value.global.value,"onUpdate:modelValue":l[1]||(l[1]=t=>h.value.global.value=t),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:i(()=>[s(k,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),s(k,{field:"username",header:"Username",sortable:""}),s(k,{field:"nama",header:"Nama",sortable:""}),s(k,{field:"level",header:"Level",sortable:""}),s(k,{exportable:!1,style:{"min-width":"12rem"}},{body:i(t=>[s(a,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:O=>P(t.data)},null,8,["onClick"]),s(a,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:O=>N(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),s(C,{visible:m.value,"onUpdate:visible":l[7]||(l[7]=t=>m.value=t),style:{width:"450px"},header:"User Details",modal:!0},{footer:i(()=>[s(a,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:S}),s(a,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:L})]),default:i(()=>[r("div",ue,[r("div",null,[ne,s(U,{id:"username",modelValue:e.value.username,"onUpdate:modelValue":l[3]||(l[3]=t=>e.value.username=t),modelModifiers:{trim:!0},required:"",invalid:n.value&&!e.value.username,fluid:""},null,8,["modelValue","invalid"]),n.value&&!e.value.username?(y(),_("small",de,"Username is required.")):g("",!0)]),r("div",null,[ve,s(U,{id:"nama",modelValue:e.value.nama,"onUpdate:modelValue":l[4]||(l[4]=t=>e.value.nama=t),modelModifiers:{trim:!0},required:"",invalid:n.value&&!e.value.nama,fluid:""},null,8,["modelValue","invalid"]),n.value&&!e.value.nama?(y(),_("small",ce,"Nama is required.")):g("",!0)]),r("div",null,[me,s(R,{id:"level",modelValue:e.value.level,"onUpdate:modelValue":l[5]||(l[5]=t=>e.value.level=t),options:[{label:"Owner",value:"owner"},{label:"Sales",value:"sales"}],optionLabel:"label",required:"",invalid:n.value&&!e.value.level,fluid:""},null,8,["modelValue","invalid"]),n.value&&!e.value.level?(y(),_("small",pe,"Level is required.")):g("",!0)]),e.value.id_user?g("",!0):(y(),_("div",fe,[be,s(U,{id:"password",modelValue:e.value.password,"onUpdate:modelValue":l[6]||(l[6]=t=>e.value.password=t),type:"password",required:"",invalid:n.value&&!e.value.password,fluid:""},null,8,["modelValue","invalid"]),n.value&&!e.value.password?(y(),_("small",_e,"Password is required.")):g("",!0)]))])]),_:1},8,["visible"]),s(C,{visible:p.value,"onUpdate:visible":l[9]||(l[9]=t=>p.value=t),style:{width:"450px"},header:"Confirm",modal:!0,onHide:l[10]||(l[10]=t=>p.value=!1)},{footer:i(()=>[s(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[8]||(l[8]=t=>p.value=!1)}),s(a,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:q})]),default:i(()=>[r("p",null,"Are you sure you want to delete "+le(e.value.nama)+"?",1)]),_:1},8,["visible"]),s(C,{visible:f.value,"onUpdate:visible":l[12]||(l[12]=t=>f.value=t),style:{width:"450px"},header:"Confirm",modal:!0,onHide:l[13]||(l[13]=t=>f.value=!1)},{footer:i(()=>[s(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[11]||(l[11]=t=>f.value=!1)}),s(a,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:I})]),default:i(()=>[ye]),_:1},8,["visible"])])}}};export{Oe as default};
