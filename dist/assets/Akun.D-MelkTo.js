import{s as Y}from"./index.Dmfi-JIL.js";import{s as j}from"./index.yeH71diU.js";import{s as G}from"./index.BimSrEtP.js";import{s as K}from"./index.D9lkt8EW.js";import{s as z,a as J}from"./index.BLUoHmHi.js";import{s as Q}from"./index.DFT7lvgp.js";import{s as W}from"./index.DSQTaGDn.js";import{s as X}from"./index.zYXIKiL0.js";import{u as d,G as Z,b1 as ee,v as le,b2 as ae,c as y,a as r,k as s,w as i,D as x,o as w,n as g,t as se,a9 as te}from"./app.DYb4vtlo.js";import"./index.D2YcutoK.js";import"./index.DBRa2qmt.js";import"./index.Dl32Gjrb.js";import"./index.QuCDjsSy.js";import"./index.C5jhljM2.js";import"./index.BIGMjE8y.js";import"./index.DU--r9eK.js";import"./index.DBHWkPF6.js";import"./index.CqPNYfth.js";import"./index.Ddk8Teb6.js";import"./index.IlhIhN8w.js";import"./index.CnjyFZOC.js";import"./index.D4jsbkbY.js";import"./index.DkZQtvKd.js";var oe={name:"Dropdown",extends:j,mounted:function(){console.warn("Deprecated since v4. Use Select component instead.")}};const re={class:"card"},ie={class:"flex flex-wrap gap-2 items-center justify-between"},ne=r("h4",{class:"m-0"},"Manage Users",-1),ue=r("i",{class:"pi pi-search"},null,-1),de={class:"flex flex-col gap-6"},ve=r("label",{for:"username",class:"block font-bold mb-3"},"Username",-1),ce={key:0,class:"text-red-500"},me=r("label",{for:"nama",class:"block font-bold mb-3"},"Nama",-1),pe={key:0,class:"text-red-500"},fe=r("label",{for:"level",class:"block font-bold mb-3"},"Level",-1),be={key:0,class:"text-red-500"},_e={key:0},ye=r("label",{for:"password",class:"block font-bold mb-3"},"Password",-1),we={key:0,class:"text-red-500"},ke=r("p",null,"Are you sure you want to delete the selected users?",-1),Ye={__name:"Akun",setup($){const U=d({global:{value:null,matchMode:te.CONTAINS}}),n=d([]),m=async()=>{try{const o=await x.get("/api/users");n.value=o.data}catch(o){console.error("Error fetching users:",o)}},C=d();Z(()=>{m(),C.value=setInterval(m,1e4)}),ee(()=>{C.value&&clearInterval(C.value)});const v=le(),D=d(),p=d(!1),f=d(!1),b=d(!1),e=d({}),_=d();ae(()=>{var l;const o=((l=U.value.global.value)==null?void 0:l.toLowerCase())||"";return n.value.filter(a=>a.username.toLowerCase().includes(o)||a.nama.toLowerCase().includes(o)||a.level.toLowerCase().includes(o))});const u=d(!1);function S(){e.value={},u.value=!1,p.value=!0}function L(){p.value=!1,u.value=!1}function P(){var o,l;if(u.value=!0,(o=e==null?void 0:e.value.username)!=null&&o.trim()&&((l=e==null?void 0:e.value.nama)!=null&&l.trim())&&(e!=null&&e.value.level)){const a={...e.value,level:e.value.level.value};e.value.id_user?x.put(`/api/users/${e.value.id_user}`,a).then(()=>{const c=M(e.value.id_user);n.value[c]=e.value,m(),v.add({severity:"success",summary:"Successful",detail:"User Updated",life:3e3})}).catch(c=>{v.add({severity:"error",summary:"Error",detail:"Failed to update user",life:3e3})}):x.post("/api/users",a).then(c=>{e.value.id_user=c.data.user.id_user,n.value.push(e.value),m(),v.add({severity:"success",summary:"Successful",detail:"User Created",life:3e3})}).catch(c=>{v.add({severity:"error",summary:"Error",detail:"Failed to create user",life:3e3})}),p.value=!1,e.value={}}}function N(o){e.value={...o},p.value=!0}function I(o){e.value=o,f.value=!0}function q(){x.delete(`/api/users/${e.value.id_user}`).then(()=>{n.value=n.value.filter(o=>o.id_user!==e.value.id_user),m(),v.add({severity:"success",summary:"Successful",detail:"User Deleted",life:3e3})}).catch(o=>{v.add({severity:"error",summary:"Error",detail:"Failed to delete user",life:3e3})}),f.value=!1,e.value={}}function M(o){let l=-1;for(let a=0;a<n.value.length;a++)if(n.value[a].id_user===o){l=a;break}return l}function E(){D.value.exportCSV()}function F(){b.value=!0}function T(){const o=_.value.map(a=>a.id_user),l=o.map(a=>x.delete(`/api/users/${a}`));Promise.all(l).then(()=>{n.value=n.value.filter(a=>!o.includes(a.id_user)),m(),v.add({severity:"success",summary:"Successful",detail:"Users Deleted",life:3e3})}).catch(a=>{v.add({severity:"error",summary:"Error",detail:"Failed to delete selected users",life:3e3})}),b.value=!1,_.value=null}return(o,l)=>{const a=X,c=W,B=z,h=Q,A=J,k=K,R=G,O=oe,V=Y;return w(),y("div",null,[r("div",re,[s(c,{class:"mb-6"},{start:i(()=>[s(a,{label:"New",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:S}),s(a,{label:"Delete",icon:"pi pi-trash",severity:"secondary",onClick:F,disabled:!_.value||!_.value.length},null,8,["disabled"])]),end:i(()=>[s(a,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:l[0]||(l[0]=t=>E(t))})]),_:1}),s(R,{ref_key:"dt",ref:D,selection:_.value,"onUpdate:selection":l[2]||(l[2]=t=>_.value=t),value:n.value,dataKey:"id_user",paginator:!0,rows:10,filters:U.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} users"},{header:i(()=>[r("div",ie,[ne,s(A,null,{default:i(()=>[s(B,null,{default:i(()=>[ue]),_:1}),s(h,{modelValue:U.value.global.value,"onUpdate:modelValue":l[1]||(l[1]=t=>U.value.global.value=t),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:i(()=>[s(k,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),s(k,{field:"username",header:"Username",sortable:""}),s(k,{field:"nama",header:"Nama",sortable:""}),s(k,{field:"level",header:"Level",sortable:""}),s(k,{exportable:!1,style:{"min-width":"12rem"}},{body:i(t=>[s(a,{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:H=>N(t.data)},null,8,["onClick"]),s(a,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:H=>I(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),s(V,{visible:p.value,"onUpdate:visible":l[7]||(l[7]=t=>p.value=t),style:{width:"450px"},header:"User Details",modal:!0},{footer:i(()=>[s(a,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:L}),s(a,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:P})]),default:i(()=>[r("div",de,[r("div",null,[ve,s(h,{id:"username",modelValue:e.value.username,"onUpdate:modelValue":l[3]||(l[3]=t=>e.value.username=t),modelModifiers:{trim:!0},required:"",invalid:u.value&&!e.value.username,fluid:""},null,8,["modelValue","invalid"]),u.value&&!e.value.username?(w(),y("small",ce,"Username is required.")):g("",!0)]),r("div",null,[me,s(h,{id:"nama",modelValue:e.value.nama,"onUpdate:modelValue":l[4]||(l[4]=t=>e.value.nama=t),modelModifiers:{trim:!0},required:"",invalid:u.value&&!e.value.nama,fluid:""},null,8,["modelValue","invalid"]),u.value&&!e.value.nama?(w(),y("small",pe,"Nama is required.")):g("",!0)]),r("div",null,[fe,s(O,{id:"level",modelValue:e.value.level,"onUpdate:modelValue":l[5]||(l[5]=t=>e.value.level=t),options:[{label:"Owner",value:"owner"},{label:"Sales",value:"sales"}],optionLabel:"label",required:"",invalid:u.value&&!e.value.level,fluid:""},null,8,["modelValue","invalid"]),u.value&&!e.value.level?(w(),y("small",be,"Level is required.")):g("",!0)]),e.value.id_user?g("",!0):(w(),y("div",_e,[ye,s(h,{id:"password",modelValue:e.value.password,"onUpdate:modelValue":l[6]||(l[6]=t=>e.value.password=t),type:"password",required:"",invalid:u.value&&!e.value.password,fluid:""},null,8,["modelValue","invalid"]),u.value&&!e.value.password?(w(),y("small",we,"Password is required.")):g("",!0)]))])]),_:1},8,["visible"]),s(V,{visible:f.value,"onUpdate:visible":l[9]||(l[9]=t=>f.value=t),style:{width:"450px"},header:"Confirm",modal:!0,onHide:l[10]||(l[10]=t=>f.value=!1)},{footer:i(()=>[s(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[8]||(l[8]=t=>f.value=!1)}),s(a,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:q})]),default:i(()=>[r("p",null,"Are you sure you want to delete "+se(e.value.nama)+"?",1)]),_:1},8,["visible"]),s(V,{visible:b.value,"onUpdate:visible":l[12]||(l[12]=t=>b.value=t),style:{width:"450px"},header:"Confirm",modal:!0,onHide:l[13]||(l[13]=t=>b.value=!1)},{footer:i(()=>[s(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[11]||(l[11]=t=>b.value=!1)}),s(a,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:T})]),default:i(()=>[ke]),_:1},8,["visible"])])}}};export{Ye as default};
